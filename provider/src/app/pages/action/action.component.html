<div class="contain">
	<div class="contain__group"  *ngIf="addShow">
		<div class="contain__group-header">
			<div class="title">
				Акция
			</div>
		</div>
		<div class="no-content" *ngIf="products && products.length === 0">
			<p>
				У вас нет продуктов, соответсвено вы не можете создать акцию
			</p>
			<button class="main-button" type="reset" (click)="cancelAdd()">Отмена</button>
		</div>
		<form class="add-section" (submit)="create($event)" *ngIf="products && products.length > 0">
			<mat-form-field class="example-full-width">
				<input matInput type="text" placeholder="Описание акции" name="name" [(ngModel)]="action.description" autocomplete="off">
			</mat-form-field>
			<select [(ngModel)]="productChoose" name="choose">
				<option *ngFor="let item of products" [value]="item._id">{{item.name}}</option>
			</select>
			<div class="block-check">
				<mat-checkbox class="check-item" [(ngModel)]="globalAction" name="global" (change)="changeTypeActionGlobal()">Глобальная акция</mat-checkbox>
				<mat-checkbox class="check-item" [(ngModel)]="userAction" name="user" (change)="changeTypeActionUser()">Для клиента</mat-checkbox>
			</div>
			<div class="chips-box" *ngIf="userChoose && userChoose.length > 0">
				<mat-chip-list aria-label="Fish selection">
					<mat-chip class="chip-item" *ngFor="let item of userChoose; let index = index">
						{{item.login}}
						<div class="remove" (click)="removeUserChip(index)">
							<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" width="15" height="15" fill="#c1c1c1">
								<path d="M 6.496094 1 C 5.675781 1 5 1.675781 5 2.496094 L 5 3 L 2 3 L 2 4 L 3 4 L 3 12.5 C 3 13.328125 3.671875 14 4.5 14 L 10.5 14 C 11.328125 14 12 13.328125 12 12.5 L 12 4 L 13 4 L 13 3 L 10 3 L 10 2.496094 C 10 1.675781 9.324219 1 8.503906 1 Z M 6.496094 2 L 8.503906 2 C 8.785156 2 9 2.214844 9 2.496094 L 9 3 L 6 3 L 6 2.496094 C 6 2.214844 6.214844 2 6.496094 2 Z M 5 5 L 6 5 L 6 12 L 5 12 Z M 7 5 L 8 5 L 8 12 L 7 12 Z M 9 5 L 10 5 L 10 12 L 9 12 Z"/>
							</svg>
						</div>
					</mat-chip>
				</mat-chip-list>
			</div>
			<mat-form-field class="example-full-width" *ngIf="userAction">
				<input type="text" placeholder="Tel" aria-label="Number" name="inputSearch" matInput [(ngModel)]="inputChange" [matAutocomplete]="auto" (keyup)="change()">
				<mat-autocomplete #auto="matAutocomplete">
					<mat-option *ngFor="let item of searchUser" [value]="item.login" (click)="pushUser(item)">
						{{item.login}}
					</mat-option>
				</mat-autocomplete>
			</mat-form-field>
			<div class="group-buttons">
				<div class="left">
					<app-upload (onFs)="onFs($event)"></app-upload>
					<div class="mat-chip-file" *ngIf="action && action.img !== ''">
						<div class="content">{{action.img}}</div>
						<div class="remove-mat-chip" (click)="action.img = ''"></div>
					</div>
				</div>
				<div class="right">
					<button class="main-button" type="reset" (click)="cancelAdd()">Отмена</button>
					<button class="main-button-color" type="submit">Сохранить</button>
				</div>
			</div>
		</form>
	</div>
	
	<div class="contain__group"  *ngIf="editShow">
		<div class="contain__group-header">
			<div class="title">
				Редактировать продукт
			</div>
		</div>
		<form (keyup)="formCheck()" (submit)="confirmEditCategoryCrud($event)" class="edit-section" *ngIf="editShow">
			<mat-form-field class="example-full-width">
				<input matInput type="text" placeholder="Описание акции" name="name" [(ngModel)]="editObj.description" autocomplete="off">
			</mat-form-field>
			<select [(ngModel)]="productChoose" (change)="selectValid()" name="choose">
				<option *ngFor="let item of products" [value]="item._id">{{item.name}}</option>
			</select>
			<div class="chips-box" *ngIf="editObj && editObj.client.length > 0">
				<mat-chip-list aria-label="Fish selection">
					<mat-chip class="chip-item" *ngFor="let item of userChoose; let index = index">
						{{item.login}}
					</mat-chip>
				</mat-chip-list>
			</div>
<!--			<mat-form-field class="example-full-width" *ngIf="editObj && editObj.client.length > 0">-->
<!--				<input type="text" placeholder="Tel" aria-label="Number" name="inputSearch" matInput [(ngModel)]="inputChange" [matAutocomplete]="auto" (keyup)="change()">-->
<!--				<mat-autocomplete #auto="matAutocomplete">-->
<!--					<mat-option *ngFor="let item of searchUser" [value]="item.login" (click)="pushUser(item)">-->
<!--						{{item.login}}-->
<!--					</mat-option>-->
<!--				</mat-autocomplete>-->
<!--			</mat-form-field>-->
			<div class="group-buttons">
				<div class="left">
					<app-upload (onFs)="onFsEdit($event)" *ngIf="editObj && editObj.img === ''"></app-upload>
					<div class="mat-chip-file" *ngIf="editObj && editObj.img !== ''">
						<div class="content">{{editObj.img.split("--")[1]}}</div>
						<div class="remove-mat-chip" (click)="editObj.img = ''; formCheck()"></div>
					</div>
				</div>
				<div class="right">
					<button class="main-button" type="reset" (click)="cancelEdit()">Отмена</button>
					<button class="main-button-color" type="submit"  *ngIf="isBlok">Сохранить</button>
				</div>
			</div>
		</form>
	</div>
	
	<div class="contain__group">
		<div class="contain__group-header">
			<div class="title">
				Все акции
			</div>
			<button class="button-add" (click)="openAdd()">
				<span class="content">Создать акцию</span>
			</button>
		</div>
		<div class="main-section">
			<div class="mat-elevation-z8">
				<mat-form-field class="filter" *ngIf="showPagin">
					<input matInput (keyup)="applyFilter($event.target.value)" placeholder="Filter">
				</mat-form-field>
				<table mat-table [dataSource]="dataSource" *ngIf="actions && actions.length > 0">
					<!-- Position Column -->
					<ng-container matColumnDef="Номер">
						<th mat-header-cell *matHeaderCellDef>#</th>
						<td mat-cell *matCellDef="let element; let index = index"> {{index + 1}} </td>
					</ng-container>
					
					<!-- Name Column -->
					<ng-container matColumnDef="Назва бренда">
						<th mat-header-cell *matHeaderCellDef>Назва акции</th>
						<td class="table__name" mat-cell *matCellDef="let element">
							<div class="table__name-img">
								<app-img [fs]="element.img"></app-img>
							</div>
							<div class="table__name-name">{{element.description}}</div>
						</td>
					</ng-container>
					
					<!-- Weight Column -->
					<ng-container matColumnDef="data">
						<th mat-header-cell *matHeaderCellDef>Дата</th>
						<td mat-cell *matCellDef="let element">
							<div class="top-table-date">
								{{element.date | date: 'dd MMMM, yyyy'  : null : defLang}}
							</div>
							<div class="bottom-table-date">
								{{element.date | date: 'h:mm a'  : null : defLang}}
							</div>
						</td>
					</ng-container>
					
					<ng-container matColumnDef="delete">
						<th mat-header-cell *matHeaderCellDef></th>
						<td class="right-section-table" mat-cell *matCellDef="let element; let index = index">
							<span class="edit-btn" (click)="edit(index)"></span>
							<span class="trash-btn" (click)="delete(index)"></span>
						</td>
					</ng-container>
					
					<tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
					<tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
				</table>
				
				<mat-paginator class="paginator-table" [pageSizeOptions]="[5, 10, 20]" [class.paginator-table-active]="showPagin"></mat-paginator>
			</div>
			<div class="empty-section" *ngIf="!actions || actions.length === 0">
				<p>
					У вас нет созданых акций
				</p>
			</div>
		</div>
	</div>

</div>
